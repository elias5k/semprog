/*! @name @brightcove/videojs-bc-playlist-ui @version 3.8.0 @license UNLICENSED */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("global/document"),require("video.js"),require("@brightcove/loscore"),require("global/window")):"function"==typeof define&&define.amd?define(["global/document","video.js","@brightcove/loscore","global/window"],e):(t=t||self).videojsBcPlaylistUi=e(t.document,t.videojs,t.videojs.bc_,t.window)}(this,(function(t,e,n,i){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n,i=i&&i.hasOwnProperty("default")?i.default:i;var a=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var l=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e},s=function(t){var e=t.playlist.autoadvance_;e.timeout&&t.clearTimeout(e.timeout),e.trigger&&t.off("ended",e.trigger),e.timeout=null,e.trigger=null},r=function t(e,n){var i;(s(e),"number"==typeof(i=n)&&!isNaN(i)&&i>=0&&i<1/0)?(e.playlist.autoadvance_.delay=n,e.playlist.autoadvance_.trigger=function(){var i=function(){return t(e,n)};e.one("play",i),e.playlist.autoadvance_.timeout=e.setTimeout((function(){s(e),e.off("play",i),e.playlist.next()}),1e3*n)},e.one("ended",e.playlist.autoadvance_.trigger)):e.playlist.autoadvance_.delay=null},o=function(t){return!!t&&"object"==typeof t},d=function(t,e){for(var n=0;n<t.length;n++){var i=t[n].sources;if(Array.isArray(i))for(var a=0;a<i.length;a++){var l=i[a];if(l&&(o=void 0,d=void 0,o=s=l,d=r=e,"object"==typeof s&&(o=s.src),"object"==typeof r&&(d=r.src),/^\/\//.test(o)&&(d=d.slice(d.indexOf("//"))),/^\/\//.test(d)&&(o=o.slice(o.indexOf("//"))),o===d))return n}}var s,r,o,d;return-1};function u(t,n,i){void 0===i&&(i=0);var a=null,l=!1,u=t.playlist=function(e,n){if(void 0===n&&(n=0),l)throw new Error("do not call playlist() during a playlist change");if(Array.isArray(e)){var i=Array.isArray(a)?a.slice():null,s=e.slice();(a=s.slice()).filter((function(t){return o(t)})).length!==a.length&&(a=function(t){var e,n=[];return t.forEach((function(t){o(t)?e=t:(e=Object(t)).originalValue=t,n.push(e)})),n}(a)),r=1,a.forEach((function(t){t.playlistItemId_=r++})),l=!0,t.trigger({type:"duringplaylistchange",nextIndex:n,nextPlaylist:s,previousIndex:u.currentIndex_,previousPlaylist:i||[]}),l=!1,-1!==n&&u.currentItem(n),i&&t.setTimeout((function(){t.trigger("playlistchange")}),0)}var r;return a.map((function(t){return t.originalValue||t})).slice()};return t.on("loadstart",(function(){-1===u.currentItem()&&s(t)})),u.currentIndex_=-1,u.player_=t,u.autoadvance_={},u.repeat_=!1,u.currentPlaylistItemId_=null,u.currentItem=function(t){if(l)return u.currentIndex_;if("number"==typeof t&&u.currentIndex_!==t&&t>=0&&t<a.length)return u.currentIndex_=t,function(t,e){var n=!t.paused()||t.ended();t.trigger("beforeplaylistitem",e.originalValue||e),e.playlistItemId_&&(t.playlist.currentPlaylistItemId_=e.playlistItemId_),t.poster(e.poster||""),t.src(e.sources),function(t){for(var e=t.remoteTextTracks(),n=e&&e.length||0;n--;)t.removeRemoteTextTrack(e[n])}(t),t.ready((function(){if((e.textTracks||[]).forEach(t.addRemoteTextTrack.bind(t)),t.trigger("playlistitem",e.originalValue||e),n){var i=t.play();void 0!==i&&"function"==typeof i.then&&i.then(null,(function(t){}))}r(t,t.playlist.autoadvance_.delay)}))}(u.player_,a[u.currentIndex_]),u.currentIndex_;var e=u.player_.currentSrc()||"";if(u.currentPlaylistItemId_){var n=function(t,e){for(var n=0;n<t.length;n++)if(t[n].playlistItemId_===e)return n;return-1}(a,u.currentPlaylistItemId_),i=a[n];if(i&&Array.isArray(i.sources)&&d([i],e)>-1)return u.currentIndex_=n,u.currentIndex_;u.currentPlaylistItemId_=null}return u.currentIndex_=u.indexOf(e),u.currentIndex_},u.contains=function(t){return-1!==u.indexOf(t)},u.indexOf=function(t){if("string"==typeof t)return d(a,t);for(var e=Array.isArray(t)?t:t.sources,n=0;n<e.length;n++){var i=e[n];if("string"==typeof i)return d(a,i);if(i.src)return d(a,i.src)}return-1},u.currentIndex=function(){return u.currentItem()},u.lastIndex=function(){return a.length-1},u.nextIndex=function(){var t=u.currentItem();if(-1===t)return-1;var e=u.lastIndex();return u.repeat_&&t===e?0:Math.min(t+1,e)},u.previousIndex=function(){var t=u.currentItem();return-1===t?-1:u.repeat_&&0===t?u.lastIndex():Math.max(t-1,0)},u.first=function(){if(!l){var t=u.currentItem(0);if(a.length)return a[t].originalValue||a[t];u.currentIndex_=-1}},u.last=function(){if(!l){var t=u.currentItem(u.lastIndex());if(a.length)return a[t].originalValue||a[t];u.currentIndex_=-1}},u.next=function(){if(!l){var t=u.nextIndex();if(t!==u.currentIndex_){var e=u.currentItem(t);return a[e].originalValue||a[e]}}},u.previous=function(){if(!l){var t=u.previousIndex();if(t!==u.currentIndex_){var e=u.currentItem(t);return a[e].originalValue||a[e]}}},u.autoadvance=function(t){r(u.player_,t)},u.repeat=function(t){return void 0===t?u.repeat_:"boolean"==typeof t?(u.repeat_=!!t,u.repeat_):void e.log.error("videojs-playlist: Invalid value for repeat",t)},u.sort=function(e){a.length&&(a.sort(e),l||t.trigger("playlistsorted"))},u.reverse=function(){a.length&&(a.reverse(),l||t.trigger("playlistsorted"))},u.shuffle=function(e){var n=(void 0===e?{}:e).rest,i=0,s=a;if(n&&(i=u.currentIndex_+1,s=a.slice(i)),!(s.length<=1)){var r;if(function(t){for(var e=-1,n=t.length-1;++e<t.length;){var i=e+Math.floor(Math.random()*(n-e+1)),a=t[i];t[i]=t[e],t[e]=a}}(s),n)(r=a).splice.apply(r,[i,s.length].concat(s));l||t.trigger("playlistsorted")}},Array.isArray(n)?u(n.slice(),i):a=[],u}var c=function(t,e){u(this,t,e)};
/*! @name videojs-playlist-ui @version 3.8.0 @license Apache-2.0 */
function h(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e.registerPlugin||e.plugin)("playlist",c),c.VERSION="4.3.1";var p,y=e.dom||e,f=e.registerPlugin||e.plugin,v={className:"vjs-playlist",playOnSelect:!1,supportsCssPointerEvents:((p=t.createElement("x")).style.cssText="pointer-events:auto","auto"===p.style.pointerEvents)},m=function(t){t.addClass("vjs-selected")},_=function(t){t.removeClass("vjs-selected"),t.thumbnail&&y.removeClass(t.thumbnail,"vjs-playlist-now-playing")},g=function(t){t.removeClass("vjs-up-next")},E=e.getComponent("Component"),b=function(n){function i(t,e,i){var a;if(!e.item)throw new Error("Cannot construct a PlaylistMenuItem without an item option");return e.showDescription=i.showDescription,(a=n.call(this,t,e)||this).item=e.item,a.playOnSelect=i.playOnSelect,a.emitTapEvents(),a.on(["click","tap"],a.switchPlaylistItem_),a.on("keydown",a.handleKeyDown_),a}h(i,n);var a=i.prototype;return a.handleKeyDown_=function(t){13!==t.which&&32!==t.which||this.switchPlaylistItem_()},a.switchPlaylistItem_=function(t){this.player_.playlist.currentItem(function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}(this.player_.playlist(),this.item)),this.playOnSelect&&this.player_.play()},a.createEl=function(){var n=t.createElement("li"),i=this.options_.item,a=this.options_.showDescription;"object"==typeof i.data&&Object.keys(i.data).forEach((function(t){var e=i.data[t];n.dataset[t]=e}));if(n.className="vjs-playlist-item",n.setAttribute("tabIndex",0),this.thumbnail=function(e){if(!e){var n=t.createElement("div");return n.className="vjs-playlist-thumbnail vjs-playlist-thumbnail-placeholder",n}var i=t.createElement("picture");if(i.className="vjs-playlist-thumbnail","string"==typeof e){var a=t.createElement("img");a.src=e,a.alt="",i.appendChild(a)}else{for(var l=0;l<e.length-1;l++){var s=e[l],r=t.createElement("source");for(var o in s)r[o]=s[o];i.appendChild(r)}var d=e[e.length-1],u=t.createElement("img");for(var c in u.alt="",d)u[c]=d[c];i.appendChild(u)}return i}(i.thumbnail),n.appendChild(this.thumbnail),i.duration){var l=t.createElement("time"),s=e.formatTime(i.duration);l.className="vjs-playlist-duration",l.setAttribute("datetime","PT0H0M"+i.duration+"S"),l.appendChild(t.createTextNode(s)),n.appendChild(l)}var r=t.createElement("span"),o=this.localize("Now Playing");r.className="vjs-playlist-now-playing-text",r.appendChild(t.createTextNode(o)),r.setAttribute("title",o),this.thumbnail.appendChild(r);var d=t.createElement("div");d.className="vjs-playlist-title-container",this.thumbnail.appendChild(d);var u=t.createElement("span"),c=this.localize("Up Next");u.className="vjs-up-next-text",u.appendChild(t.createTextNode(c)),u.setAttribute("title",c),d.appendChild(u);var h=t.createElement("cite"),p=i.name||this.localize("Untitled Video");if(h.className="vjs-playlist-name",h.appendChild(t.createTextNode(p)),h.setAttribute("title",p),d.appendChild(h),a){var y=t.createElement("div"),f=i.description||"";y.className="vjs-playlist-description",y.appendChild(t.createTextNode(f)),y.setAttribute("title",f),d.appendChild(y)}return n},i}(E),x=function(n){function i(t,i){var a;if(!t.playlist)throw new Error("videojs-playlist is required for the playlist component");return(a=n.call(this,t,i)||this).items=[],i.horizontal?a.addClass("vjs-playlist-horizontal"):a.addClass("vjs-playlist-vertical"),i.supportsCssPointerEvents&&a.addClass("vjs-csspointerevents"),a.createPlaylist_(),e.browser.TOUCH_ENABLED||a.addClass("vjs-mouse"),a.on(t,["loadstart","playlistchange","playlistsorted"],(function(t){a.update()})),a.on(t,"adstart",(function(){a.addClass("vjs-ad-playing")})),a.on(t,"adend",(function(){a.removeClass("vjs-ad-playing")})),a.on("dispose",(function(){a.empty_(),t.playlistMenu=null})),a.on(t,"dispose",(function(){a.dispose()})),a}h(i,n);var a=i.prototype;return a.createEl=function(){return y.createEl("div",{className:this.options_.className})},a.empty_=function(){this.items&&this.items.length&&(this.items.forEach((function(t){return t.dispose()})),this.items.length=0)},a.createPlaylist_=function(){var e=this.player_.playlist()||[],n=this.el_.querySelector(".vjs-playlist-item-list"),i=this.el_.querySelector(".vjs-playlist-ad-overlay");n||((n=t.createElement("ol")).className="vjs-playlist-item-list",this.el_.appendChild(n)),this.empty_();for(var a=0;a<e.length;a++){var l=new b(this.player_,{item:e[a]},this.options_);this.items.push(l),n.appendChild(l.el_)}i?n.appendChild(i):((i=t.createElement("li")).className="vjs-playlist-ad-overlay",n.appendChild(i));var s=this.player_.playlist.currentItem();if(this.items.length&&s>=0){m(this.items[s]);var r=this.items[s].$(".vjs-playlist-thumbnail");r&&y.addClass(r,"vjs-playlist-now-playing")}},a.update=function(){var e=this.player_.playlist();if(this.items.length===e.length){for(var n=0;n<this.items.length;n++)if(this.items[n].item!==e[n])return void this.createPlaylist_();for(var i=this.player_.playlist.currentItem(),a=0;a<this.items.length;a++){var l=this.items[a];a===i?(m(l),t.activeElement!==l.el()&&y.addClass(l.thumbnail,"vjs-playlist-now-playing"),g(l)):a===i+1?(_(l),l.addClass("vjs-up-next")):(_(l),g(l))}}else this.createPlaylist_()},i}(E),C=function(t){for(var e=0;e<t.childNodes.length;e++)if(y.isEl(t.childNodes[e]))return!0;return!1},I=function(n){if(!this.playlist)throw new Error("videojs-playlist plugin is required by the videojs-playlist-ui plugin");if(y.isEl(n)&&(e.log.warn('videojs-playlist-ui: Passing an element directly to playlistUi() is deprecated, use the "el" option instead!'),n={el:n}),n=e.mergeOptions(v,n),this.playlistMenu){var i=this.playlistMenu.el();if(i){var a=i.parentNode,l=i.nextSibling;this.playlistMenu.dispose(),y.emptyEl(i),l?a.insertBefore(i,l):a.appendChild(i),n.el=i}}y.isEl(n.el)||(n.el=function(e){for(var n,i=t.querySelectorAll("."+e),a=0;a<i.length;a++)if(!C(i[a])){n=i[a];break}return n}(n.className)),this.playlistMenu=new x(this,n)};e.registerComponent("PlaylistMenu",x),e.registerComponent("PlaylistMenuItem",b),f("playlistUi",I),I.VERSION="3.8.0";var w=function(t){function e(e,n){var i;return(i=t.call(this,e,n)||this).controlText(i.localize("Next playlist item")),i.on(e,["adstart"],i.disable),i.on(e,["adend","adtimeout"],i.enable),i}l(e,t);var n=e.prototype;return n.buildCSSClass=function(){return"vjs-next-button "+t.prototype.buildCSSClass.call(this)},n.createEl=function(){return t.prototype.createEl.call(this,"button",{innerHTML:'<span class="vjs-icon-placeholder" aria-hidden="true"></span>'})},n.handleClick=function(t){this.player_.playlist.next(),this.options_.playOnSelect&&this.player_.play()},e}(e.getComponent("Button"));e.registerComponent("NextButton",w);var S=function(t){function s(i,l){var s;return(s=t.call(this,i,l)||this).haveSeenEnded_=!1,s.haveSeenNoPostroll_=!1,s.closeButton_=s.addChild("CloseButton"),s.on("click",s.handleClick),s.throttledHandleTimeupdate_=n.throttle(e.bind(a(s),s.handleTimeupdate_),200),s.boundHandleEnded_=e.bind(a(s),s.handleEnded_),s.boundHandleLoadstart_=e.bind(a(s),s.handleLoadstart_),s.on(s.closeButton_,"close",s.handleClose_),s.on(i,"adstart",s.handleAdStart_),s.on(i,"nopostroll",s.handleNoPostroll_),s.toggleListeners_("on"),s}l(s,t);var r=s.prototype;return r.createEl=function(){this.countdownEl_=e.dom.createEl("div",{className:"vjs-next-overlay-countdown"}),this.nameEl_=e.dom.createEl("div",{className:"vjs-next-overlay-name"}),this.bannerEl_=e.dom.createEl("div",{className:"vjs-next-overlay-banner"},{},[this.countdownEl_,this.nameEl_]);var n=t.prototype.createEl.call(this,"div",{className:"vjs-next-overlay vjs-hidden"});return n.appendChild(this.bannerEl_),n},r.dispose=function(){this.bannerEl_=null,this.countdownEl_=null,this.nameEl_=null,this.imageEl_&&e.off(this.imageEl_),this.imageEl_=null,t.prototype.dispose.call(this)},r.handleClick=function(t){var e=this.closeButton_.el();t.target===e||e.contains(t.target)||this.player_.playlist.next()},r.handleStateChanged=function(t){var n=this,a=t.changes,l=this.state,s=l.name,r=l.seconds,o=l.thumbnail;if(a.seconds){var d=this.localize("Up next");this.canShowCountdown_()&&"number"==typeof r&&(d=this.localize("Up next in {1} seconds",[r])),e.dom.textContent(this.countdownEl_,d)}if(a.name&&e.dom.textContent(this.nameEl_,s||""),a.thumbnail&&(this.imageEl_&&this.el_.removeChild(this.imageEl_),"string"==typeof o&&/\S/.test(o))){var u=this.imageEl_=new i.Image;u.src=o,u.alt="",e.on(u,"load",(function(){e.dom.appendContent(n.el_,u)})),e.on(u,"error",(function(){n.imageEl_=null}))}},r.shouldShow_=function(){var t=this.player(),e=t.playlist;return!(this.hiddenByUser_||e.nextIndex()===e.currentIndex()||t.getChild("NextEndscreen")&&t.ended())},r.canShowCountdown_=function(){var t=this.player();return"number"==typeof t.playlist.autoadvance_.delay&&(!t.usingPlugin("ads")||this.haveSeenNoPostroll_||this.haveSeenEnded_)},r.getRemaining_=function(){var t=this.player(),e=t.duration(),n=t.currentTime();if(!(n<(e>30?e-10:Math.ceil(.6666*e)))){var i=Math.ceil(e)-Math.ceil(n);return t.playlist.autoadvance_.delay&&(i+=t.playlist.autoadvance_.delay),i}},r.handleClose_=function(){this.hiddenByUser_=!0,this.hide()},r.toggleListeners_=function(t){this[t](this.player_,"ended",this.boundHandleEnded_),this[t](this.player_,"loadstart",this.boundHandleLoadstart_),this[t](this.player_,"timeupdate",this.throttledHandleTimeupdate_)},r.handleAdStart_=function(){var t=this;this.hide(),this.toggleListeners_("off"),this.one(this.player_,["adend","adtimeout"],(function(){t.toggleListeners_("on")}))},r.handleNoPostroll_=function(){this.haveSeenNoPostroll_=!0},r.handleEnded_=function(){var t=this;if(this.haveSeenEnded_=!0,this.clearInterval(this.countdownInterval_),this.shouldShow_()){var e=this.player().playlist.autoadvance_.delay;if(e>0){var n=Date.now();this.show(),this.state.seconds=null,this.setState({seconds:e}),this.countdownInterval_=this.setInterval((function(){var i=Date.now();i-n>=1e3&&(n=i,e--,t.setState({seconds:e}),0===e&&t.clearInterval(t.countdownInterval_))}),100)}}else this.hide()},r.handleLoadstart_=function(){var t=this.player().playlist,e=t()[t.nextIndex()];this.clearInterval(this.countdownInterval_),this.hiddenByUser_=!1,this.haveSeenEnded_=!1,this.haveSeenNoPostroll_=!1,this.hide(),e&&this.setState({name:e.name,thumbnail:e.thumbnail})},r.handleTimeupdate_=function(){this.shouldShow_()?(this.setState({seconds:this.getRemaining_()}),this.state.seconds>=0?this.show():this.hide()):this.hide()},s}(e.getComponent("Component"));e.registerComponent("NextOverlay",S);var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P=function(t,e){return"function"==typeof t.usingPlugin?t.usingPlugin(e):"ads"===e?"object"===j(t.ads):"playlist"===e?!(!t.playlist||"object"!==j(t.playlist.autoadvance_)):!!t[e]},N=function(t){t.postrollStarted=!1,t.postrollFinished=!1,t.postrollTimedOut=!1,t.sawNoPostrollEvent=!1},O=function(){var t=this;if(!this.endscreenState_){var e=this.endscreenState_={},n=function(){return t.trigger("endscreen")};N(e),this.on("adstart",(function(){var n=t.ended();e.postrollStarted=n,e.postrollFinished=!n})),this.on("adend",(function(){e.postrollFinished=t.ended()})),this.on("adtimeout",(function(){e.postrollTimedOut=t.ended()})),this.on(["endscreen","loadstart"],(function(){t.off("adend",n),N(e)})),this.on("nopostroll",(function(){e.sawNoPostrollEvent=!0})),this.on("ended",(function(){(function(t){if(!P(t,"playlist"))return!1;var e=t.playlist,n=e();return!(0!==e.autoadvance_.delay||!n.length)&&(e.repeat()||e.currentItem()!==n.length-1)})(t)||(!function(t){if(!P(t,"ads"))return!1;var e=t.endscreenState_;return!e.sawNoPostrollEvent&&(e.postrollStarted&&!e.postrollFinished&&!e.postrollTimedOut)}(t)?n():t.one("adend",n))}))}};e.registerPlugin?e.getPlugin("endscreen")||e.registerPlugin("endscreen",O):e.plugin("endscreen",O);var T=i.Date,A=e.getComponent("Button"),B=e.getComponent("ModalDialog"),k=function(t){return"string"==typeof t&&/\S/.test(t)},H=function(t){function e(){return t.apply(this,arguments)||this}l(e,t);var n=e.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},n.handleClick=function(t){t.stopPropagation(),this.player_.playlist.next()},e}(A),U=function(t){function n(e,n){var i;return i=t.call(this,e,n)||this,e.endscreen(),i.closeable(!1),i.on("click",i.handleClick),i.on(e,"endscreen",i.handleEndscreen_),i.on(e,"loadstart",i.handleLoadstart_),i.on(e,"adstart",i.handleAdStart_),i}l(n,t);var a=n.prototype;return a.buildCSSClass=function(){return"vjs-next-endscreen "+t.prototype.buildCSSClass.call(this)},a.dispose=function(){this.countdownEl_=null,this.nameEl_=null,this.thumbPlay_&&this.thumbPlay_.dispose(),this.imageEl_&&e.off(this.imageEl_),this.imageEl_=null,this.thumbEl_=null,t.prototype.dispose.call(this)},a.content=function(){var t=this;return this.countdownEl_=e.dom.createEl("div",{className:"vjs-next-endscreen-countdown"}),this.nameEl_=e.dom.createEl("div",{className:"vjs-next-endscreen-name"}),this.thumbEl_=e.dom.createEl("div",{className:"vjs-next-endscreen-thumbnail"}),k(this.state.name)&&e.dom.textContent(this.nameEl_,this.state.name),this.thumbPlay_&&(this.thumbPlay_.dispose(),this.thumbPlay_=null),k(this.state.thumbnail)?(this.imageEl_=new i.Image,this.imageEl_.src=this.state.thumbnail,this.imageEl_.alt="",e.on(this.imageEl_,"load",(function(){t.thumbPlay_=new H(t.player()),e.dom.appendContent(t.thumbEl_,[t.imageEl_,t.thumbPlay_.el()])})),e.on(this.imageEl_,"error",(function(){t.imageEl_=null}))):(this.thumbEl_=null,this.imageEl_=null),[this.countdownEl_,this.nameEl_,this.thumbEl_]},a.handleClick=function(t){this.player_.playlist.next()},a.handleStateChanged=function(t){var n=this;t.changes.seconds&&this.requestAnimationFrame((function(){e.dom.textContent(n.countdownEl_,n.localize("Up next in {1} seconds",[n.state.seconds]))}))},a.shouldOpen_=function(){var t=this.player(),e=t.playlist;return!(t.usingPlugin("customEndscreen")||t.usingPlugin("social")&&t.socialOverlay&&t.socialOverlay.asEndscreen())&&(e.nextIndex()!==e.currentIndex()&&"number"==typeof e.autoadvance_.delay)},a.handleEndscreen_=function(){var t=this;if(this.clearInterval(this.countdownInterval_),this.shouldOpen_()){var e=this.player().playlist.autoadvance_.delay;if(e>0){var n=T.now();this.open(),this.setState({seconds:e}),this.countdownInterval_=this.setInterval((function(){var i=T.now();i-n>=1e3&&(n=i,e--,t.setState({seconds:e}),0===e&&t.clearInterval(t.countdownInterval_))}),100)}}else this.close()},a.handleLoadstart_=function(){var t=this.player().playlist,e=t()[t.nextIndex()];this.clearInterval(this.countdownInterval_),this.close(),e&&this.setState({name:e.name,seconds:void 0,thumbnail:e.thumbnail})},a.handleAdStart_=function(){this.opened()&&(this.clearInterval(this.countdownInterval_),this.setState({seconds:void 0}),this.close())},n}(B);U.prototype.options_={fillAlways:!0,pauseOnOpen:!0,temporary:!1},e.registerComponent("NextEndscreen",U);var M=function(t){function n(){return t.apply(this,arguments)||this}l(n,t);var i=n.prototype;return i.createEl=function(){return this.listEl_=e.dom.createEl("div",{className:"vjs-playlist"}),e.dom.createEl("div",{className:"vjs-playlist-sidebar vjs-playlist-sidebar-"+this.options_.orientation},{},this.listEl_)},i.listEl=function(){return this.listEl_},i.toggleHidden=function(){},n}(e.getComponent("Component"));e.registerComponent("PlaylistSidebar",M);var z=function(n){function i(e,i){var a;return(a=n.call(this,e,i)||this).setState({hidden:!!i.hideOnStart}),a.on(a.showHideEl_,"click",(function(){return a.toggleHidden()})),a.on(a.showHideEl_.children[0],["focus","blur"],(function(){a.toggleClass("vjs-show-hide-focus")})),a.on(e,"play",(function(){return a.toggleHidden(!0)})),a.on(t.body,["mouseenter","mouseleave"],(function(t){a.hasClass("vjs-show-hide-focus")||a.toggleClass("vjs-playlist-show-hide-hidden","mouseleave"===t.type)})),a}l(i,n);var a=i.prototype;return a.createEl=function(){var t=n.prototype.createEl.call(this);return this.showHideBtnEl_=e.dom.createEl("button"),this.showHideEl_=e.dom.createEl("div",{className:"vjs-playlist-show-hide"},{},this.showHideBtnEl_),t.appendChild(this.showHideEl_),t},a.handleStateChanged=function(t){var n=this;if(t.changes.hidden){var i=t.changes.hidden.to;this.toggleClass("vjs-playlist-hidden",i),e.dom.textContent(this.showHideBtnEl_,i?"<":">"),this.setState({animating:!0})}if(t.changes.animating){var a=t.changes.animating.to;this.toggleClass("vjs-playlist-animating",a),a&&this.setTimeout((function(){return n.setState({animating:!1})}),50)}},a.toggleHidden=function(t){void 0===t&&(t=!this.state.hidden),this.state.animating||this.setState({hidden:t})},i}(M);z.defaultState={hidden:void 0,animating:!1},e.registerComponent("CollapsiblePlaylistSidebar",z);var D=e.getPlugin("plugin"),L={hideOnStart:!1,nextButton:!0,nextOverlay:!0,nextEndscreen:!0,playOnSelect:!1,repeat:!1,shuffle:!1,playlistPicker:!0},q=e.dom,V=function(i){function s(n,l){var s;(s=i.call(this,n,l)||this).options=e.mergeOptions(L,l),n.addClass("vjs-playlist-enabled"),s.orientation_=s.options.horizontal?"horizontal":"vertical",s.isInIframe_=q.hasClass(t.documentElement,"bc-iframe");var r=n.el().parentNode;return s.isInIframe_?(s.containerEl_=t.body,q.addClass(s.containerEl_,"vjs-playlist-player-container")):q.hasClass(r,"vjs-playlist-player-container")&&(s.containerEl_=r),s.initPlaylist_(),s.initPlaylistUi_(),s.initNextButton_(),s.initNextEndscreen_(),s.initNextOverlay_(),s.options.playlistPicker&&(s.handlePlaylistChangeBound_=e.bind(a(s),s.handlePlaylistChange_),s.on(n,"playlistchange",s.handlePlaylistChangeBound_),s.handlePlaylistChangeBound_()),s}l(s,i);var r=s.prototype;return r.toggleSidebar=function(){this.sidebar_&&this.sidebar_.toggleHidden()},r.dispose=function(){var t=this;i.prototype.dispose.call(this),["sidebar_","nextButton_","nextOverlay_","nextEndscreen_"].forEach((function(e){t[e]&&t[e].dispose()}))},r.initNextButton_=function(){var t=this.options,e=t.nextButton,i=t.playOnSelect;if(e){n.isObj(e)||(e={}),e.hasOwnProperty("playOnSelect")||(e.playOnSelect=!!i);var a=this.player.getChild("controlBar"),l=a.children().map((function(t){return t.name()})).indexOf("PlayToggle")+1;this.nextButton_=a.addChild("NextButton",e,l)}},r.initNextOverlay_=function(){var t=this.options.nextOverlay;t&&(n.isObj(t)||(t={}),this.nextOverlay_=this.player.addChild("NextOverlay",t))},r.initNextEndscreen_=function(){var t=this.options.nextEndscreen;t&&(n.isObj(t)||(t={}),this.nextEndscreen_=this.player.addChild("NextEndscreen",t))},r.initPlaylist_=function(){var t=this.options,e=this.player;t.shuffle&&e.on("duringplaylistchange",(function(){return e.playlist.shuffle()})),e.playlist(t.playlist),e.playlist.repeat(!!t.repeat),void 0!==t.autoadvance&&e.playlist.autoadvance(t.autoadvance)},r.initPlaylistUi_=function(){var n=this,i=this.options,a=this.player,l=a.el().parentNode,s={horizontal:i.horizontal,playOnSelect:i.playOnSelect};this.options.playlistPicker&&(this.containerEl_&&(i.horizontal?this.sidebar_=a.addChild("PlaylistSidebar",{orientation:this.orientation_}):this.sidebar_=a.addChild("CollapsiblePlaylistSidebar",{hideOnStart:i.hideOnStart,orientation:this.orientation_})),this.sidebar_?(l.appendChild(this.sidebar_.el()),s.el=this.sidebar_.listEl(),this.finalizePlaylistUi_(s)):"loading"!==t.readyState?this.finalizePlaylistUi_(s):e.one(t,"DOMContentLoaded",(function(){n.finalizePlaylistUi_(s)})))},r.finalizePlaylistUi_=function(e){var n=this.player,i=n.bcinfo,a=n.tagAttributes,l=i&&i.playerId||a["data-player"],s=i&&i.embedId||a["data-embed"],r=i&&i.applicationId||a["data-application-id"];if(n.el()){var o=t.querySelector('.vjs-playlist[data-for="'+n.id()+'"]');if(o)e.el=o;else if(l&&s)for(var d=Array.prototype.slice.call(t.querySelectorAll('.vjs-playlist[data-player="'+l+'"][data-embed="'+s+'"]')),u=0;u<d.length;u++){var c=d[u];if(!r){e.el=c;break}if(r===c.getAttribute("data-application-id")){e.el=c;break}}e.showDescription=this.options.showDescription,n.playlistUi(e)}},r.handlePlaylistChange_=function(){var t=this.player.playlist().length>0;this.sidebar_&&(t?this.sidebar_.show():this.sidebar_.hide());var e="vjs-playlist-"+this.orientation_+"-enabled";this.containerEl_&&q.toggleClass(this.containerEl_,e,t)},s}(D);return e.registerPlugin("bcPlaylistUi",V),V.VERSION="3.8.0",V}));
